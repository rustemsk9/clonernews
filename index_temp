// Polls the Hacker News topstories endpoint and logs size changes

const TOP_STORIES_URL = 'https://hacker-news.firebaseio.com/v0/topstories.json';

let previousSize = null;

async function checkTopStoriesSize() {
  try {
    const response = await fetch(TOP_STORIES_URL);
    const topStories = await response.json();
    const currentSize = Array.isArray(topStories) ? topStories.length : 0;

    if (previousSize === null) {
      console.log('Initial size:', currentSize);
    } else if (currentSize !== previousSize) {
      console.log(`Size changed: ${previousSize} -> ${currentSize}`);
    }

    previousSize = currentSize;
  } catch (error) {
    console.error('Error fetching top stories:', error);
  }
}

// Poll every 10 seconds
setInterval(checkTopStoriesSize, 10000);

// Run once at start
checkTopStoriesSize();